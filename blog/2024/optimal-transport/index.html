<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Optimal Transport | Ziye Chen </title> <meta name="author" content="Ziye Chen"> <meta name="description" content="this is an introduction about Optimal Transport"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ziye2chen.github.io/blog/2024/optimal-transport/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Optimal Transport",
            "description": "this is an introduction about Optimal Transport",
            "published": "March 23, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ziye</span> Chen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Optimal Transport</h1> <p>this is an introduction about Optimal Transport</p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#intro-to-optimal-transport">Intro to Optimal Transport</a> </div> <ul> <li> <a href="#measure">Measure</a> </li> <li> <a href="#the-monge-formulation">The Monge Formulation</a> </li> <li> <a href="#the-kantorovich-formulation">The Kantorovich Formulation</a> </li> <li> <a href="#wasserstein-distance">Wasserstein Distance</a> </li> </ul> <div> <a href="#duality">Duality</a> </div> <ul> <li> <a href="#reminder-of-dual-problem">Reminder of Dual Problem</a> </li> <li> <a href="#kantorovich-duality">Kantorovich Duality</a> </li> </ul> </nav> </d-contents> <h2 id="intro-to-optimal-transport">Intro to Optimal Transport</h2> <p>Optimal transport problem can be understood as a problem of two piles of soil, shoveled from soil A to the other and eventually piled up to form soil B. And your mission is to find the most efficient method to shovel the soil.</p> <p>There are two ways to formulate the optimal transport problem: the Monge and Kantorovich formulations. Historically the Monge formulation comes before Kantorovich. The Kantorovich formulation can be seen as a generalisation of Monge. Both formulations have their advantages and disadvantages. Monge is more useful in applications, whilst Kantorovich is more useful theoretically.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/soil-480.webp 480w,/assets/img/optimalTransport/soil-800.webp 800w,/assets/img/optimalTransport/soil-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/soil.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="measure">Measure</h3> <p>In mathematics, measure is a generalization and formalization of geometrical measures like length, area, volume, magnitude, mass and probability. In Lebesgue measure, for lower dimensions n = 1, 2, or 3, it coincides with the standard measure of length, area, or volume.</p> <p>The concept of measures will be used later, and before I introduce probability measures, I need to introduce the histogram. The histogram here is the probability of n sums of 1, representing a probability distribution. We will use interchangeably the terms histogram and probability vector for any element $a \in \Sigma_n $ that belongs to the probability simplex</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_1-480.webp 480w,/assets/img/optimalTransport/equation/1_1-800.webp 800w,/assets/img/optimalTransport/equation/1_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>And we use discrete measure describes a probability measure if, additionally, \(a \in \Sigma_n\) and more generally a positive measure if all the elements of vector \(a\) are non-negative.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_2-480.webp 480w,/assets/img/optimalTransport/equation/1_2-800.webp 800w,/assets/img/optimalTransport/equation/1_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>And to avoid degeneracy issues where locations with no mass are accounted for, we will assume when considering discrete measures that all the elements of \(a\) are positive.</p> <p>A convenient feature of OT is that it can deal with measures that are either or both discrete and continuous within the same framework. So we can find a relation between discrete measures and general measures.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_3-480.webp 480w,/assets/img/optimalTransport/equation/1_3-800.webp 800w,/assets/img/optimalTransport/equation/1_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="the-monge-formulation">The Monge Formulation</h3> <p>In optimal transport, there are two measures \(\mu\) and \(\nu\). You can imagine they are two piles of soil (but I will call them measure for the rest). And you can also consider the first measure \(\mu\) as a pile of sand and the second measure \(\nu\) as a hole we wish to fill up. We assume that both measures are probability measures on spaces $X$ and $Y$ respectively. The cost function \(c(x,y)\), \(c:X \to [0,+\infty]\), measures the cost of transporting one unit of mass from \(x \in X\) to \(y \in Y\). Now, the problem is to find the most optimal method.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_4-480.webp 480w,/assets/img/optimalTransport/equation/1_4-800.webp 800w,/assets/img/optimalTransport/equation/1_4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>For greter generality we work with the inverse of \(T\) itself. The inverse is treated in the general set valued sense, i.e. \(x \in T^{-1}(y)\) if \(T(x)=y\), if the function \(T\) is injective then we can equivalently say that \(\nu (T(A)) = \mu (A)\) for all \(\mu\)-measurable \(A\).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/T-480.webp 480w,/assets/img/optimalTransport/T-800.webp 800w,/assets/img/optimalTransport/T-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/T.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_5_1_6-480.webp 480w,/assets/img/optimalTransport/equation/1_5_1_6-800.webp 800w,/assets/img/optimalTransport/equation/1_5_1_6-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_5_1_6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Transport map \(T\) does not always exist. For example, there are two discrete measures \(\mu = \delta_{x_1}\), \(\nu = \frac{1}{2} \delta_{y_1} + \frac{1}{2} \delta_{y_2}\), where \(y_1 \not= y_2\). Then \(\nu({y_1}) = \frac{1}{2}\) but \(\mu(T^{-1}(y_1)) \in \{0,1\}\) depending on whether \(x \in T^{-1}(y_1)\). Hence no transport maps exist.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_7-480.webp 480w,/assets/img/optimalTransport/equation/1_7-800.webp 800w,/assets/img/optimalTransport/equation/1_7-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The original monge’s optimal transport problem used \(L^1\) cost, i.e. \(c(x,y) = \mid x - y \mid\). But it is much harder to solve than with \(L^2\) cost, i.e. \(c(x,y) = \mid x - y \mid^2\).</p> <p>If the measure is discrete measure, we can also define the Monge’s optimal transport problem between discrete measures.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_8-480.webp 480w,/assets/img/optimalTransport/equation/1_8-800.webp 800w,/assets/img/optimalTransport/equation/1_8-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_8.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="the-kantorovich-formulation">The Kantorovich Formulation</h3> <p>In the example \(\mu = \delta_{x_1}\), \(\nu = \frac{1}{2} \delta_{y_1} + \frac{1}{2} \delta_{y_2}\), it causes problem in Monge formulation because mass cannot be split. To allow mass to be split, the Kantorovich formulation appears, which has a natural relaxation. To formalize this, we consider a measure \(\pi \in \mathcal{P}(X \times Y)\) and think of \(d\pi(x,y)\) as the amount of mass transferred from $x$ to $y$. And we have the constrains:</p> <p>\(\pi(A \times Y) = \mu (A)\), \(\pi(X \times B) = \nu (B)\) for all mesaurable sets \(A \subseteq X\), \(B \subseteq Y\).</p> <p>And we denote the set of such \(\pi\) by \(\Pi(\mu,\nu)\) and call \(\Pi(\mu,\nu)\) the set of transport plans between \(\mu\) and \(\nu\). \(\Pi(\mu,\nu)\) is never non-empty and \(\mu \otimes \nu \in \Pi(\mu,\nu)\). Now we can define Kantorovich’s formulation of optimal transport.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_9-480.webp 480w,/assets/img/optimalTransport/equation/1_9-800.webp 800w,/assets/img/optimalTransport/equation/1_9-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_9.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The Kantorovich problem is convex (the constrains are convex and one usually has that the cost functon \(c(x,y) = d(x-y)\) where d is convex). And we can also define the Kantorovich problem in discrete measures.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_10-480.webp 480w,/assets/img/optimalTransport/equation/1_10-800.webp 800w,/assets/img/optimalTransport/equation/1_10-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_10.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>And this is a linear programme. So Kantorovich is considered as the inventor of linear programming.</p> <h3 id="wasserstein-distance">Wasserstein Distance</h3> <p>When we talk about cost, it is always Eulerian based cost, such as \(L^P\), which defines a metric based on “pointwise differences”. However, this cost has some disadvantages. In the optimal transportation process, the probabilities between two points correspond to varying probabilities. Suppose the Euclidean distance is directly used to calculate the loss of transportation (or to measure and evaluate the transportation process). In that case, it will lead to a significant bias in the final evaluation (i.e., directly ignoring the definition of the probability vectors of the original different points).</p> <p>Optimal transport can be understood as a canonical way to lift a ground distance between points to a distance between historgram or measures. In order to evaluate the goodness of mapped paths for optimal transportation choices, the Wasserstein distance was developed.</p> <p>To give a clearer idea of what the Wasserstein distance does, suppose the three functions f,g, and h are in the figure below. If you were to represent the distance between f and g and the distance between f and h with L-infinity norm, you would find that the distance between f and g and between f and h are almost the same (\(\left \| f-g \right \|_{\infty } \approx \left \| f-h \right \|_{\infty }\)). However, under the Wasserstein distance, the distance between f and h is much larger than between f and g (\(d_{w_1}(f,q) &lt; d_{w_1} (f,h)\)).</p> <p>The \(f, g, h\) functions on \(R\):</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/fgh-480.webp 480w,/assets/img/optimalTransport/fgh-800.webp 800w,/assets/img/optimalTransport/fgh-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/fgh.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>You can also see the difference between L-infinity norm and Wasserstein distance from the geodesics in the space of functions. If I want to move the function f to the function h, the changes of geodesics in figures below are totally different.</p> <p>The geodesics under L-infinity norm:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/normGeodesics-480.webp 480w,/assets/img/optimalTransport/normGeodesics-800.webp 800w,/assets/img/optimalTransport/normGeodesics-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/normGeodesics.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The geodesics under Wasserstein distance:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/wGeodesics-480.webp 480w,/assets/img/optimalTransport/wGeodesics-800.webp 800w,/assets/img/optimalTransport/wGeodesics-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/wGeodesics.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>If we define Wasserstein distance based on the space of probability measures on \(X \subset \mathbb{R}^d\) with bounded \(p^{th}\) moment, i.e.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_11-480.webp 480w,/assets/img/optimalTransport/equation/1_11-800.webp 800w,/assets/img/optimalTransport/equation/1_11-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_11.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>If \(X\) is bounded then \(\mathcal{P}_p(X)=\mathcal{P}(X)\). The Wasserstein distance can be define as</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/1_12-480.webp 480w,/assets/img/optimalTransport/equation/1_12-800.webp 800w,/assets/img/optimalTransport/equation/1_12-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/1_12.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>And the wasserstein distance also satisfies the positive definiteness and triangular inequalities of the fugitive space.</p> <h2 id="duality">Duality</h2> <p>We saw in the previous chapter how Kantorovich’s optimal transport problem resembles a linear programme. It should not therefore be surprising that Kantorovich’s optimal transport problem admits a dual formulation.</p> <p>In optimization theory, turn original optimizing problem into dual problem can easily make it more easier to solve. Regardless of the difficulty of the original problem, dual problems are convex, and convex problems are a class of problems that are relatively easy to solve. When the original problem is a particularly difficult one, it is relatively easy to solve by reducing it to a dyadic problem</p> <h3 id="reminder-of-dual-problem">Reminder of Dual Problem</h3> <p>All optimization problems, in theory, can be transformed into standard form:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/dual1-480.webp 480w,/assets/img/optimalTransport/equation/dual1-800.webp 800w,/assets/img/optimalTransport/equation/dual1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/dual1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>And then we define Lagrangian function:</p> \[L(x, \lambda, \mu) = f_0(x) + \sum_{i=1}^{m} \lambda_i f_i(x) + \sum_{j=1}^{p} \mu_j h_j(x)\] <p>With the Lagrangian function, we introduce the Lagrange dual function:</p> \[g(\lambda, \mu) = \inf_{x \in \mathcal{D}} L(x, \lambda, \mu)\] <p>The Lagrange dual function is the Lagrangian function that minimizes with respect to x. And we get the (Lagrangian) dual problem from the standard problem:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/dual2-480.webp 480w,/assets/img/optimalTransport/equation/dual2-800.webp 800w,/assets/img/optimalTransport/equation/dual2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/dual2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="kantorovich-duality">Kantorovich Duality</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/2_1-480.webp 480w,/assets/img/optimalTransport/equation/2_1-800.webp 800w,/assets/img/optimalTransport/equation/2_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/2_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Let \(\Phi_c\) defined by</p> \[\Phi_c = \{(\varphi, \psi) \in L^1(\mu) \times L^1(\nu) : \varphi(x) + \psi(y) \leq c(x, y)\}\] <p>where the inequality is understood to hold for \(\mu\)-almost every \(x \in X\) and \(\nu\)-almost every \(y \in Y\). Then,</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/2_2-480.webp 480w,/assets/img/optimalTransport/equation/2_2-800.webp 800w,/assets/img/optimalTransport/equation/2_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/2_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>And if we look at the discrete optimal transport problem,</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/dual3-480.webp 480w,/assets/img/optimalTransport/equation/dual3-800.webp 800w,/assets/img/optimalTransport/equation/dual3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/dual3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>its dual problem is</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/optimalTransport/equation/2_3-480.webp 480w,/assets/img/optimalTransport/equation/2_3-800.webp 800w,/assets/img/optimalTransport/equation/2_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/optimalTransport/equation/2_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <div id="disqus_thread" style="max-width: 930px; margin: 0 auto;"> <script type="text/javascript">var disqus_shortname="al-folio",disqus_identifier="/blog/2024/optimal-transport",disqus_title="Optimal Transport";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Ziye Chen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"About",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"post-encoder",title:"Encoder",description:"this is a blog about the encoder in transformer",section:"Posts",handler:()=>{window.location.href="/blog/2024/Encoder/"}},{id:"post-introduction-to-kan",title:"Introduction to KAN",description:"this is an introduction about KAN",section:"Posts",handler:()=>{window.location.href="/blog/2024/kan/"}},{id:"post-the-detail-about-attention-structure",title:"The detail about Attention structure",description:"this is the detail about attention structure",section:"Posts",handler:()=>{window.location.href="/blog/2024/attention/"}},{id:"post-modern-solution-of-optimal-transport-sinkhorn",title:"Modern Solution of Optimal Transport - Sinkhorn",description:"this is my study note about sinkhorn",section:"Posts",handler:()=>{window.location.href="/blog/2024/sinkhorn/"}},{id:"post-optimal-transport",title:"Optimal Transport",description:"this is an introduction about Optimal Transport",section:"Posts",handler:()=>{window.location.href="/blog/2024/optimal-transport/"}},{id:"news-i-39-m-starting-my-m-s-in-artificial-intelligence-at-boston-university",title:"I&#39;m starting my M.S. in Artificial Intelligence at Boston University.",description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%7A%69%79%65%63%68%65%6E@%62%75.%65%64%75","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>